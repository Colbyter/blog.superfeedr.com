<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="google-site-verification" content="ofroHQ3qXBS1SQfblK9-U_oduGZ975Bb3i_uP13Myao" />

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,400italic|Source+Code+Pro:400,600' rel='stylesheet' type='text/css'>

  <link href="/css/front.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/css/prism.css" rel="stylesheet" type="text/css">

  <title>Superfeedr : JSON Path subscriptions </title>

  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">
  <link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />

  <meta http-equiv="Content-Security-Policy" content="connect-src stream.superfeedr.com">

  <link rel="shortcut icon" href="/favicon.png">

</head>
<body>
  <header class="header">
    <div class="container">
      <h1 class="header-logo"><a href="/"><img src="/images/logo.png" alt=""> <span>Superfeedr Blog</span></a></h1>
      <nav class="nav-header">
        <ul class="nav-items">
          <li class="nav-item"><a href="http://superfeedr.com/about" class="nav-link">About</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/publisher" class="nav-link">Publishers</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/subscriber" class="nav-link">Subscribers</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/subscriber/pricing" class="nav-link">Pricing</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/login" class="nav-link nav-link-bubble">Login</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container body">
    <header class="body-header">
      <div class="blog-links">
        <input type="button" class="button  button--raised  button--positive" value="Subscribe" onclick="(function(){var z=document.createElement('script');z.src='http://www.subtome.com/load.js';document.body.appendChild(z);})()">
        <a href="/archive.html" class="button  button--raised  button--neutral">Read Archives</a>
      </div>
      <h2><strong>Blog</strong></h2>
    </header>

    <div class="body-content">
      <section class="column  column--terms  body-content-text">
        <article class="blog-article blog-article--single h-entry">
  <h3 class="entry-title p-name"><a class="u-url" href="/json-path">JSON Path subscriptions</a></h3>

  <span class="invisible u-uid" style="display:none">blog.superfeedr.com:/json-path</span>

  <div class="entry-meta">
    <ul class="entry-meta--primary postmeta">
      <li class="entry-meta--item">By <span class="p-author h-card"><img class="u-photo" src="http://www.gravatar.com/avatar/b30ce50678f0e934eaa6697425c59dd7?s=20" > <a href="http://ouvre-boite.com" rel="author">Julien</a></span></li>
      <li class="entry-meta--item dt-published" datetime="2014-09-25T00:00:00+02:00"><time>25 Sep 2014</time></li>
    </ul>
  </div>
  <div class="entry-content e-content">
    <p>A bunch of our customers use Superfeedr to poll JSON APIs. Rather than wasting their resources, they use us to <strong>subscribe</strong> to JSON documents using <strong>webhooks</strong>. When the document eventually updates, we push them the whole document.</p>

<p>Yet, most of the time, they’re not interested in the <em>whole document</em>, just parts of it, and up until today, there was no way to subscribe to parts of it.</p>

<h3 id="getting-too-much-information">Getting too much information</h3>

<p>Let’s assume my awesome application displays user profiles from <a href="https://github.com/">Github</a>. It does not display the whole profile, but only a few interesting fields, including the login name and avatar.</p>

<p>Github has a nice API to retrieve a user’s profile. (some fields removed)</p>

<pre data-line=""><code class="language-javascript">$ curl https://api.github.com/users/julien51
{
  &quot;login&quot;: &quot;julien51&quot;,
  &quot;avatar_url&quot;: &quot;https://avatars.githubusercontent.com/u/17735?v=2&quot;,
  &quot;public_repos&quot;: 68,
  &quot;public_gists&quot;: 114,
  &quot;followers&quot;: 156,
  &quot;following&quot;: 127
}</code></pre>

<p>If you subscribe to <code>https://api.github.com/users/julien51</code> using Superfeedr, you’ll get a new notification for each update to this user profile. You’ll get a notification when the avatar is updated, but you’ll also get a notification when somebody starts to follow me or when I <a href="https://gist.github.com/">create a gist</a>… even though my awesome application does not really care about that.</p>

<h3 id="jsonpath">JSONPath</h3>

<p>We’ve had <a href="http://blog.superfeedr.com/fragment-subscription/">HTML fragments</a> for a couple years now, today we’re introducing <a href="http://documentation.superfeedr.com/subscribers.html#json-fragments">JSON fragments</a> using the exact same principle: append a <a href="http://goessner.net/articles/JsonPath/">JSONPath</a> to the fragment part of URL of a JSON document and you’ll get notifications only when this part if the JSON document changes.</p>

<blockquote>
  <p>A JSONPath is way to select only parts of a JSON document, using ancestry (<em>I want the third child of the books element</em>), or more complex matchers like <em>I want elements whose value of X is Y</em>.</p>
</blockquote>

<p>For example above, if you subscribed to <code>https://api.github.com/users/julien51#%24.avatar_url</code>, you’ll be notified only when the <code>avatar_url</code> changes (<code>%24.avatar_url</code> is <code>$.avatar_url</code> urlencoded).</p>

<p>If you’re looking for more information about JSONPath you should read more on <a href="http://goessner.net/articles/JsonPath/">Stefan Goessner site</a> and you can test your expressions using <a href="http://jsonpath.curiousconcept.com/">this web application</a>.</p>

<h3 id="never-miss-a-train">Never miss a train!</h3>

<p>Another great example comes from <a href="http://pieter.pm/">Pieter Colpaert</a>. <a href="https://irail.be/">irail.be</a> has the times of all trains in Belgium in all stations. When you pick the page of a station, like the one for <a href="https://irail.be/stations/NMBS/008892007">Gent-Sint-Pieters</a>, you get the list of trains. By fetching this page with a <code>application/json</code> header, you get a JSON representation of the upcoming trains.</p>

<pre data-line=""><code class="language-javascript">{
    &quot;@context&quot;: {
        &quot;delay&quot;: &quot;http://semweb.mmlab.be/ns/rplod/delay&quot;,
        &quot;platform&quot;: &quot;http://semweb.mmlab.be/ns/rplod/platform&quot;,
        &quot;scheduledDepartureTime&quot;: &quot;http://semweb.mmlab.be/ns/rplod/scheduledDepartureTime&quot;,
        &quot;headsign&quot;: &quot;http://vocab.org/transit/terms/headsign&quot;,
        &quot;routeLabel&quot;: &quot;http://semweb.mmlab.be/ns/rplod/routeLabel&quot;,
        &quot;stop&quot;: {
            &quot;@id&quot;: &quot;http://semweb.mmlab.be/ns/rplod/stop&quot;,
            &quot;@type&quot;: &quot;@id&quot;
        }
    },
    &quot;@graph&quot;: [
        {
            &quot;@id&quot;: &quot;http://irail.be/stations/NMBS/008892007/departures/20140926095185d62cd764ea09216c5783586c5b90ba&quot;,
            &quot;delay&quot;: &quot;600&quot;,
            &quot;platform&quot;: &quot;7&quot;,
            &quot;scheduledDepartureTime&quot;: &quot;2014-09-26T09:51:00+02:00&quot;,
            &quot;stop&quot;: &quot;http://irail.be/stations/NMBS/008892007&quot;,
            &quot;headsign&quot;: &quot;De Panne&quot;,
            &quot;routeLabel&quot;: &quot;IR 3631&quot;
        },
        {
            &quot;@id&quot;: &quot;http://irail.be/stations/NMBS/008892007/departures/201409261001e93879f9830d734825c817aa195c4141&quot;,
            &quot;delay&quot;: &quot;0&quot;,
            &quot;platform&quot;: &quot;9&quot;,
            &quot;scheduledDepartureTime&quot;: &quot;2014-09-26T10:01:00+02:00&quot;,
            &quot;stop&quot;: &quot;http://irail.be/stations/NMBS/008892007&quot;,
            &quot;headsign&quot;: &quot;Knokke&quot;,
            &quot;routeLabel&quot;: &quot;IC 1530&quot;
        },
...
        {
            &quot;@id&quot;: &quot;http://irail.be/stations/NMBS/008892007/departures/20140926110453628a1532e8c3f47417df57e60b0dcd&quot;,
            &quot;delay&quot;: &quot;0&quot;,
            &quot;platform&quot;: &quot;7&quot;,
            &quot;scheduledDepartureTime&quot;: &quot;2014-09-26T11:04:00+02:00&quot;,
            &quot;stop&quot;: &quot;http://irail.be/stations/NMBS/008892007&quot;,
            &quot;headsign&quot;: &quot;Tongeren&quot;,
            &quot;routeLabel&quot;: &quot;IC 1510&quot;
        }
    ]
}</code></pre>

<p>Now, I’m not interested in all trains leaving this station, just the trains to <a href="https://en.wikipedia.org/wiki/Knokke">Knokke</a>, because it’s friday and I want to enjoy a weekend by the sea. I can use this JSONPath: <code>$..@graph[?(@.headsign=="Knokke")]</code> to get all the children of the <code>@graph</code> element with a <code>headsign</code> of “Knokke”. This would yield something like this:</p>

<pre data-line=""><code class="language-javascript">[{
  &quot;@id&quot;: &quot;http://irail.be/stations/NMBS/008892007/departures/201409261001e93879f9830d734825c817aa195c4141&quot;,
  &quot;delay&quot;: &quot;0&quot;,
  &quot;platform&quot;: &quot;9&quot;,
  &quot;scheduledDepartureTime&quot;: &quot;2014-09-26T10:01:00+02:00&quot;,
  &quot;stop&quot;: &quot;http://irail.be/stations/NMBS/008892007&quot;,
  &quot;headsign&quot;: &quot;Knokke&quot;,
  &quot;routeLabel&quot;: &quot;IC 1530&quot;
}]</code></pre>

<p>And there, I have the info I need for the next train. It then becomes incredibly more actionable if I use Superfeedr to subscribe to that specific bit of content using this <code>https://irail.be/stations/NMBS/008892007#%24..%40graph%5B%3F(%40.headsign%3D%3D%22Knokke%22)%5D</code> <sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup>. I now have a webhook for when a new train from Gent-Sint-Pieters to Knokke is about to leave! Also, the payload of the webhook includes all the info I need: the departure time, the platform and any potential delay. You can inspect a couple past notificationsr recived on <a href="http://requestb.in/12j1ps91?inspect">this requestbin</a>.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><code>%24..%40graph%5B%3F(%40.headsign%3D%3D%22Knokke%22)%5D</code> is <code>$..@graph[?(@.headsign=="Knokke")]</code> urlencoded <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

  </div>
</article>
<div class="blog-more">
  Liked this post? <a href="/archive.html">Read the archive</a> or <input type="button" value="Subscribe" class="button  button--raised  button--positive" onclick="(function(){var z=document.createElement('script');z.src='http://www.subtome.com/load.js';document.body.appendChild(z);})()">
</div>
<div class="blog-comments">
  <h3>Comments</h3>

    <div id="disqus_thread">
    </div>

    <script type="text/javascript" src="https://disqus.com/forums/superfeedr-thoughts/embed.js"></script>
    <noscript>
        <a href="https://superfeedr-thoughts.disqus.com/?url=ref">View the discussion thread.</a>
    </noscript>

    <script id="webmention-hosted">
    (function () {
      var sn = document.createElement("script"), s = document.getElementsByTagName("script")[0], url;
      url = document.querySelectorAll ? document.querySelectorAll("link[rel~=canonical]") : false;
      url = url && url[0] ? url[0].href : false;
      sn.type = "text/javascript"; sn.async = true;
      sn.src = "//webmention.herokuapp.com/api/embed?url=" + encodeURIComponent(url || window.location);
      s.parentNode.insertBefore(sn, s);
    }());
    </script>
</div>

      </section>
    </div>

  </main>

  <div class="footer container">
    <footer class="site-footer">
      <ul class="site-footer__list">
<!--         <li class="site-footer__item"><a href="" class="site-footer__link">Documentation</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Support</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Blog</a></li>
        <li class="site-footer__item"><a href="/pricing.html" class="site-footer__link">Pricing</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Terms</a></li>
 -->      </ul>
      <ul class="site-footer__meta">
        <p class="site-footer__copyright">&copy; 2009&ndash;2014 Superfeedr</p>
      </ul>
    </footer>
  </div>



  


  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  <!--//--><![CDATA[//><!--
  try {
    var pageTracker = _gat._getTracker('UA-9285763-1');
    pageTracker._setDomainName("superfeedr.com");
    pageTracker._initData();
    pageTracker._trackPageview();
  } catch(err) {}
  //--><!]]>
  </script>

  <script src="/scripts/prism.js"></script>

</body>
</html>




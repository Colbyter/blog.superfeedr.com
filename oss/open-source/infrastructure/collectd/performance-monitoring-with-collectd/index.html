<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="google-site-verification" content="ofroHQ3qXBS1SQfblK9-U_oduGZ975Bb3i_uP13Myao" />

  <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,400italic|Source+Code+Pro:400,600' rel='stylesheet' type='text/css'>

  <link href="/css/front.css" media="screen" rel="stylesheet" type="text/css" />
  <link href="/css/prism.css" rel="stylesheet" type="text/css">

  <title>Superfeedr : Performance monitoring with collectd </title>

  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">
  <link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />

  <meta http-equiv="Content-Security-Policy" content="connect-src stream.superfeedr.com">

  <link rel="shortcut icon" href="/favicon.png">

</head>
<body>
  <header class="header">
    <div class="container">
      <h1 class="header-logo"><a href="/"><img src="/images/logo.png" alt=""> <span>Superfeedr Blog</span></a></h1>
      <nav class="nav-header">
        <ul class="nav-items">
          <li class="nav-item"><a href="http://superfeedr.com/about" class="nav-link">About</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/publisher" class="nav-link">Publishers</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/subscriber" class="nav-link">Subscribers</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/subscriber/pricing" class="nav-link">Pricing</a></li>
          <li class="nav-item"><a href="http://superfeedr.com/login" class="nav-link nav-link-bubble">Login</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container body">
    <header class="body-header">
      <div class="blog-links">
        <input type="button" class="button  button--raised  button--positive" value="Subscribe" onclick="(function(){var z=document.createElement('script');z.src='http://www.subtome.com/load.js';document.body.appendChild(z);})()">
        <a href="/archive.html" class="button  button--raised  button--neutral">Read Archives</a>
      </div>
      <h2><strong>Blog</strong></h2>
    </header>

    <div class="body-content">
      <section class="column  column--terms  body-content-text">
        <article class="blog-article blog-article--single h-entry">
  <h3 class="entry-title p-name"><a class="u-url" href="/oss/open-source/infrastructure/collectd/performance-monitoring-with-collectd">Performance monitoring with collectd</a></h3>

  <span class="invisible u-uid" style="display:none">blog.superfeedr.com:/oss/open-source/infrastructure/collectd/performance-monitoring-with-collectd</span>

  <div class="entry-meta">
    <ul class="entry-meta--primary postmeta">
      <li class="entry-meta--item">By <span class="p-author h-card"><img class="u-photo" src="http://www.gravatar.com/avatar/0120a25badc6b1e50f6890527dca7042?s=20" > <a href="http://identi.ca/astro" rel="author">Astro</a></span></li>
      <li class="entry-meta--item dt-published" datetime="2009-08-07T00:00:00+02:00"><time>07 Aug 2009</time></li>
    </ul>
  </div>
  <div class="entry-content e-content">
    <p>One challenge we face when working in the Cloud is knowing <strong>when to <a href="http://blog.superfeedr.com/chef/configuration/deployment/infrastructure/scale-with-chef/">scale up</a>.</strong> That means we need some obvious figures telling us we need more resources.</p>
<p><img src="/images/collectd.png" style="float: right; margin: 5px;" alt="" /> This requires performance monitoring. From the many tools around we chose <a href="http://collectd.org/">collectd</a>. This daemon is built on a very sleek plugin infrastructure, allowing it to run with only the functionality you actually need. If you want to know how clean C looks the collectd source code is worth a look.</p>
<p>Contrary to a lot of other monitoring software, the watched hosts don&#8217;t have listening network sockets but <strong>only send <span class="caps">UDP</span> packets</strong> to a central server. It&#8217;s not necessary to control any data gathering from the outside, thus it avoids potential remote security holes.</p>
<p><img src="/images/collectd-mem.png" style="float:left; margin: 10px;" alt="" /> The primary use of collectd is <strong>monitoring of operating system resources</strong> and this is done very efficiently by its native plugins. There&#8217;s no expensive <code>fork()</code> for calling other programs. If you still need that, there&#8217;s a <a href="http://collectd.org/documentation/manpages/collectd-exec.5.shtml">exec</a> plugin for that.</p>
<p>Once you figured out which host is responsible for gathering all the data, you can configure collectd&#8217;s <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_network">network plugin</a> to open a listening socket for receiving other hosts&#8217; statistics.</p>
<p>To make use of the collected data you&#8217;ve got the <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_rrdtool">rrdtool plugin</a> which writes locally-generated or remotely-received values into the round-robin database files of the popular and proven <a href="http://oss.oetiker.ch/rrdtool/">rrdtool</a>. Pay attention to the configuration of that plugin: once you start monitoring dozens of hosts with hundreds of plugins, rrdtool will randomly write to the many <span class="caps">RRD</span> files. There are some tunable parameters and the <a href="http://collectd.org/documentation/manpages/collectd.conf.5.shtml#plugin_rrdcached">rrdcached</a> solution.</p>
<p><img src="/images/collectd-superparsr.png" style="float:right; margin: 10px;" alt="" /> You can generate your pretty graphs with the <strong>rrdgraph</strong> utility. This is being done by the included <strong>collection3</strong> <span class="caps">CGI</span> scripts. Unfortunately, this web interface is rather Web 1.0 and allows basic browsing of your graphs only. We hope for the advent of some alternative projects to allow more convenient viewing of statistics.</p>
<p>Because we do not only want to watch host resources but also the quality of our processes we have developed the <a href="http://github.com/astro/ruby-collectd/">ruby-collectd</a> library. Basically, you just define a collectd server on application startup and sprinkle your code with statements like <code>Stats.counter(:job_done).count! 1</code></p>
<p>ruby-collectd does not require collectd, so you don&#8217;t need to install it locally just for watching your own application.</p>
  </div>
</article>
<div class="blog-more">
  Liked this post? <a href="/archive.html">Read the archive</a> or <input type="button" value="Subscribe" class="button  button--raised  button--positive" onclick="(function(){var z=document.createElement('script');z.src='http://www.subtome.com/load.js';document.body.appendChild(z);})()">
</div>
<div class="blog-comments">
  <h3>Comments</h3>

    <div id="disqus_thread">
    </div>

    <script type="text/javascript" src="https://disqus.com/forums/superfeedr-thoughts/embed.js"></script>
    <noscript>
        <a href="https://superfeedr-thoughts.disqus.com/?url=ref">View the discussion thread.</a>
    </noscript>

    <script id="webmention-hosted">
    (function () {
      var sn = document.createElement("script"), s = document.getElementsByTagName("script")[0], url;
      url = document.querySelectorAll ? document.querySelectorAll("link[rel~=canonical]") : false;
      url = url && url[0] ? url[0].href : false;
      sn.type = "text/javascript"; sn.async = true;
      sn.src = "//webmention.herokuapp.com/api/embed?url=" + encodeURIComponent(url || window.location);
      s.parentNode.insertBefore(sn, s);
    }());
    </script>
</div>

      </section>
    </div>

  </main>

  <div class="footer container">
    <footer class="site-footer">
      <ul class="site-footer__list">
<!--         <li class="site-footer__item"><a href="" class="site-footer__link">Documentation</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Support</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Blog</a></li>
        <li class="site-footer__item"><a href="/pricing.html" class="site-footer__link">Pricing</a></li>
        <li class="site-footer__item"><a href="" class="site-footer__link">Terms</a></li>
 -->      </ul>
      <ul class="site-footer__meta">
        <p class="site-footer__copyright">&copy; 2009&ndash;2014 Superfeedr</p>
      </ul>
    </footer>
  </div>



  


  <script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script>
  <script type="text/javascript">
  <!--//--><![CDATA[//><!--
  try {
    var pageTracker = _gat._getTracker('UA-9285763-1');
    pageTracker._setDomainName("superfeedr.com");
    pageTracker._initData();
    pageTracker._trackPageview();
  } catch(err) {}
  //--><!]]>
  </script>

  <script src="/scripts/prism.js"></script>

</body>
</html>



